var u = {}

u.hash = function (t, e) {
  return u.hashBinary(l(t), e)
}

var e = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f"]

function o(t, e) {
  var o = t[0]
    , n = t[1]
    , i = t[2]
    , s = t[3]
  n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n & i | ~n & s) + e[0] - 680876936 | 0) << 7 | o >>> 25) + n | 0) & n | ~o & i) + e[1] - 389564586 | 0) << 12 | s >>> 20) + o | 0) & o | ~s & n) + e[2] + 606105819 | 0) << 17 | i >>> 15) + s | 0) & s | ~i & o) + e[3] - 1044525330 | 0) << 22 | n >>> 10) + i | 0,
    n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n & i | ~n & s) + e[4] - 176418897 | 0) << 7 | o >>> 25) + n | 0) & n | ~o & i) + e[5] + 1200080426 | 0) << 12 | s >>> 20) + o | 0) & o | ~s & n) + e[6] - 1473231341 | 0) << 17 | i >>> 15) + s | 0) & s | ~i & o) + e[7] - 45705983 | 0) << 22 | n >>> 10) + i | 0,
    n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n & i | ~n & s) + e[8] + 1770035416 | 0) << 7 | o >>> 25) + n | 0) & n | ~o & i) + e[9] - 1958414417 | 0) << 12 | s >>> 20) + o | 0) & o | ~s & n) + e[10] - 42063 | 0) << 17 | i >>> 15) + s | 0) & s | ~i & o) + e[11] - 1990404162 | 0) << 22 | n >>> 10) + i | 0,
    n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n & i | ~n & s) + e[12] + 1804603682 | 0) << 7 | o >>> 25) + n | 0) & n | ~o & i) + e[13] - 40341101 | 0) << 12 | s >>> 20) + o | 0) & o | ~s & n) + e[14] - 1502002290 | 0) << 17 | i >>> 15) + s | 0) & s | ~i & o) + e[15] + 1236535329 | 0) << 22 | n >>> 10) + i | 0,
    n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n & s | i & ~s) + e[1] - 165796510 | 0) << 5 | o >>> 27) + n | 0) & i | n & ~i) + e[6] - 1069501632 | 0) << 9 | s >>> 23) + o | 0) & n | o & ~n) + e[11] + 643717713 | 0) << 14 | i >>> 18) + s | 0) & o | s & ~o) + e[0] - 373897302 | 0) << 20 | n >>> 12) + i | 0,
    n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n & s | i & ~s) + e[5] - 701558691 | 0) << 5 | o >>> 27) + n | 0) & i | n & ~i) + e[10] + 38016083 | 0) << 9 | s >>> 23) + o | 0) & n | o & ~n) + e[15] - 660478335 | 0) << 14 | i >>> 18) + s | 0) & o | s & ~o) + e[4] - 405537848 | 0) << 20 | n >>> 12) + i | 0,
    n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n & s | i & ~s) + e[9] + 568446438 | 0) << 5 | o >>> 27) + n | 0) & i | n & ~i) + e[14] - 1019803690 | 0) << 9 | s >>> 23) + o | 0) & n | o & ~n) + e[3] - 187363961 | 0) << 14 | i >>> 18) + s | 0) & o | s & ~o) + e[8] + 1163531501 | 0) << 20 | n >>> 12) + i | 0,
    n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n & s | i & ~s) + e[13] - 1444681467 | 0) << 5 | o >>> 27) + n | 0) & i | n & ~i) + e[2] - 51403784 | 0) << 9 | s >>> 23) + o | 0) & n | o & ~n) + e[7] + 1735328473 | 0) << 14 | i >>> 18) + s | 0) & o | s & ~o) + e[12] - 1926607734 | 0) << 20 | n >>> 12) + i | 0,
    n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n ^ i ^ s) + e[5] - 378558 | 0) << 4 | o >>> 28) + n | 0) ^ n ^ i) + e[8] - 2022574463 | 0) << 11 | s >>> 21) + o | 0) ^ o ^ n) + e[11] + 1839030562 | 0) << 16 | i >>> 16) + s | 0) ^ s ^ o) + e[14] - 35309556 | 0) << 23 | n >>> 9) + i | 0,
    n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n ^ i ^ s) + e[1] - 1530992060 | 0) << 4 | o >>> 28) + n | 0) ^ n ^ i) + e[4] + 1272893353 | 0) << 11 | s >>> 21) + o | 0) ^ o ^ n) + e[7] - 155497632 | 0) << 16 | i >>> 16) + s | 0) ^ s ^ o) + e[10] - 1094730640 | 0) << 23 | n >>> 9) + i | 0,
    n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n ^ i ^ s) + e[13] + 681279174 | 0) << 4 | o >>> 28) + n | 0) ^ n ^ i) + e[0] - 358537222 | 0) << 11 | s >>> 21) + o | 0) ^ o ^ n) + e[3] - 722521979 | 0) << 16 | i >>> 16) + s | 0) ^ s ^ o) + e[6] + 76029189 | 0) << 23 | n >>> 9) + i | 0,
    n = ((n += ((i = ((i += ((s = ((s += ((o = ((o += (n ^ i ^ s) + e[9] - 640364487 | 0) << 4 | o >>> 28) + n | 0) ^ n ^ i) + e[12] - 421815835 | 0) << 11 | s >>> 21) + o | 0) ^ o ^ n) + e[15] + 530742520 | 0) << 16 | i >>> 16) + s | 0) ^ s ^ o) + e[2] - 995338651 | 0) << 23 | n >>> 9) + i | 0,
    n = ((n += ((s = ((s += (n ^ ((o = ((o += (i ^ (n | ~s)) + e[0] - 198630844 | 0) << 6 | o >>> 26) + n | 0) | ~i)) + e[7] + 1126891415 | 0) << 10 | s >>> 22) + o | 0) ^ ((i = ((i += (o ^ (s | ~n)) + e[14] - 1416354905 | 0) << 15 | i >>> 17) + s | 0) | ~o)) + e[5] - 57434055 | 0) << 21 | n >>> 11) + i | 0,
    n = ((n += ((s = ((s += (n ^ ((o = ((o += (i ^ (n | ~s)) + e[12] + 1700485571 | 0) << 6 | o >>> 26) + n | 0) | ~i)) + e[3] - 1894986606 | 0) << 10 | s >>> 22) + o | 0) ^ ((i = ((i += (o ^ (s | ~n)) + e[10] - 1051523 | 0) << 15 | i >>> 17) + s | 0) | ~o)) + e[1] - 2054922799 | 0) << 21 | n >>> 11) + i | 0,
    n = ((n += ((s = ((s += (n ^ ((o = ((o += (i ^ (n | ~s)) + e[8] + 1873313359 | 0) << 6 | o >>> 26) + n | 0) | ~i)) + e[15] - 30611744 | 0) << 10 | s >>> 22) + o | 0) ^ ((i = ((i += (o ^ (s | ~n)) + e[6] - 1560198380 | 0) << 15 | i >>> 17) + s | 0) | ~o)) + e[13] + 1309151649 | 0) << 21 | n >>> 11) + i | 0,
    n = ((n += ((s = ((s += (n ^ ((o = ((o += (i ^ (n | ~s)) + e[4] - 145523070 | 0) << 6 | o >>> 26) + n | 0) | ~i)) + e[11] - 1120210379 | 0) << 10 | s >>> 22) + o | 0) ^ ((i = ((i += (o ^ (s | ~n)) + e[2] + 718787259 | 0) << 15 | i >>> 17) + s | 0) | ~o)) + e[9] - 343485551 | 0) << 21 | n >>> 11) + i | 0,
    t[0] = o + t[0] | 0,
    t[1] = n + t[1] | 0,
    t[2] = i + t[2] | 0,
    t[3] = s + t[3] | 0
}


function n(t) {
  var e, o = []
  for (e = 0; e < 64; e += 4)
    o[e >> 2] = t.charCodeAt(e) + (t.charCodeAt(e + 1) << 8) + (t.charCodeAt(e + 2) << 16) + (t.charCodeAt(e + 3) << 24)
  return o
}

function s(t) {
  var e, i, s, r, a, c, l = t.length, d = [1732584193, -271733879, -1732584194, 271733878]
  for (e = 64; e <= l; e += 64)
    o(d, n(t.substring(e - 64, e)))
  for (i = (t = t.substring(e - 64)).length,
         s = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
         e = 0; e < i; e += 1)
    s[e >> 2] |= t.charCodeAt(e) << (e % 4 << 3)
  if (s[e >> 2] |= 128 << (e % 4 << 3),
  e > 55)
    for (o(d, s),
           e = 0; e < 16; e += 1)
      s[e] = 0
  return r = (r = 8 * l).toString(16).match(/(.*?)(.{0,8})$/),
    a = parseInt(r[2], 16),
    c = parseInt(r[1], 16) || 0,
    s[14] = a,
    s[15] = c,
    o(d, s),
    d
}

function a(t) {
  var o, n = ""
  for (o = 0; o < 4; o += 1)
    n += e[t >> 8 * o + 4 & 15] + e[t >> 8 * o & 15]
  return n
}

function c(t) {
  var e
  for (e = 0; e < t.length; e += 1)
    t[e] = a(t[e])
  return t.join("")
}

u.hashBinary = function (t, e) {
  var o = c(s(t))
  return o
}

var config = {
  scene: 'pic_edit'
}

// var e1 = Date.now()

function l(t) {
  return /[\u0080-\uFFFF]/.test(t) && (t = unescape(encodeURIComponent(t))),
    t
}


export function getPictureParams(src) {
  const timestamp = Date.now()
  const token = u.hash(u.hash(src) + config.scene + timestamp.toString() + '').slice(0, 5)
  return {
    timestamp,
    token
  }
}
